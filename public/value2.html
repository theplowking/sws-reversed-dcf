<!DOCTYPE html>
<head>
  <meta charset="utf-8">
<title>Mr Reverse DCF</title>
<style>

body {
  font: 16px sans-serif;
  /*background: #304459;
    color: white;*/
}

</style>
    <link rel="stylesheet" href="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <link rel="stylesheet" href="/css/slider.css">
    <script src="//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
    <link rel="stylesheet" href="/css/chartist-plugin-tooltip.css">
    <script src="js/chartist-plugin-tooltip.js"></script>
    <script src="js/dcf.js"></script>
    <script src="js/scenarios.js"></script>
  </head>

<body onload="runMe()">
  <img src="https://upload.wikimedia.org/wikipedia/en/thumb/8/86/Einstein_tongue.jpg/220px-Einstein_tongue.jpg" style="width:100px;"/>
  <h1>Mr Reverse Discounted Cash Flow aka Implied Growth</h1>

 
  <input type="text" id="stocks" placeholder="Simply Wall St ticker e.g. NasdaqGS:FB" style="width:250px;"/>
  <button type="submit" type="button" onclick="download()">Reverse DCF me!</button>

<div style="width:48%; min-width: 250px; display:inline-block; border: solid 1px #eee;">
  <h5>Next 3 years growth rate</h5>
      <div class="slider-container">

        <div class="slider-labels">
          <div class='label'>-50%</div>
          <div class='label'>0%</div>
          <div class='label'>50%</div>
          <div class='label'>100%</div>
          <div class='label'>150%</div>
          <div class='label'>200%</div>
        </div> 
        <input id="growthSlider" type="range" min="-50" max="200" step="1" value="0" class="slider">  
    </div>

    Growth rate: <input type="text" id="growthInput">%
</div>

<div style="width:48%; min-width: 250px; display:inline-block; border: solid 1px #eee;">
  <h5>Risk (discount rate)</h5>
      <div class="slider-container">

        <div class="slider-labels">
          <div class='label'>Low</div>
          <div class='label'>Medium</div>
          <div class='label'>High</div>
          <div class='label'>Very High</div>
        </div> 
        <input id="riskSlider" type="range" min="8" max="14" step="0.1" value="10" class="slider">  
    </div>

    Discount rate: <input type="text" id="riskInput">%
</div>

<div style="width:48%; min-width: 250px; display:inline-block; border: solid 1px #eee;">
  <h5>Free Cash Flow Today</h5>

    Free Cash Flow: <input type="text" id="fcfInput" value="1000">M
</div>

<div style="width:48%; min-width: 250px; display:inline-block; border: solid 1px #eee;">
  <h5>Long term growth rate (perpetual growth)</h5>

    Perpetual growth: <input type="text" id="riskFreeInput" value="1.9">%
</div>


  <br><br>
  <div id="resultsArea"></div>
  <br>
  <h3>Free Cash Flow Stage 1 Detail (reporting currency, millions)</h3>
  <div class="ct-chart ct-minor-seventh" style="height:250px;"></div>

  
</body>
<script>

var growthSlide = document.getElementById('growthSlider'),
    growthInput = document.getElementById("growthInput"),
    riskSlide = document.getElementById('riskSlider'),
    riskInput = document.getElementById("riskInput"),
    fcfInput = document.getElementById("fcfInput"),
    riskFreeInput = document.getElementById("riskFreeInput");

growthSlide.onchange = function() {
    growthInput.value = this.value;
    updateDCF();
}



riskSlide.onchange = function() {
    riskInput.value = this.value;
    updateDCF();
}

growthInput.onchange = function() { updateDCF(); }
riskInput.onchange = function() { updateDCF(); }
fcfInput.onchange = function() { updateDCF(); }
riskFreeInput.onchange = function() { updateDCF(); }





function runMe()
{

}

function download()
{
//NasdaqGS:GOOG,NasdaqGS:AMZN,NasdaqGS:FB,NasdaqGS:MTCH,NasdaqGS:MSFT,NasdaqGS:NFLX,NasdaqGS:NVDA,TSX:XID
//retreive()
test();

}


// const retreive = async () => {
//   let stock = document.getElementById('stocks').value;
//   document.getElementById('resultsArea').innerHTML = "Fetching "+stock+" for you...";

//   try {
//     const response = await fetch("/reverse_dcf?stock="+stock);

//     if(response.status!==200)
//        {
//           throw new Error(response.status)
//        }

//     const results = await response.json(); //extract JSON from the http response
//     console.log(results);

//     if (results.assumptions.fcf < 0)
//     {
//       let text = `${results.name}'s current free cash flow is negative at ${results.assumptions.fcf}, boo.`;


//     document.getElementById('resultsArea').innerHTML = text;
//     }
//     else
//     {
//       let text = `<p>A share price of ${results.share_price} implies that ${results.name} will grow free cash flow by <strong>${results.result.growth.toFixed(2)}%</strong> per year in the short term.\
//       </p>\
//       <p>To put this in perspective:</p>\
//       <UL><LI>In the past 3 years they've grown earnings at a rate of ${results.past_growth.toFixed(2)}% per year.</LI>\
//       <LI>Analysts estimate they will grow earnings at a rate of ${results.future_growth.toFixed(2)}% per year over the next 3 years.</LI>`;

//       if ( results.analyst_count > 0){
//         text += `<LI>The analysts estimate for free cash flow growth is ${results.past_fcf_growth.toFixed(2)}% per year over th next 3 years.</li>`;

//       }
//       else
//       {
//         text += `<LI>In the past 3 year free cash flow growth was ${results.past_fcf_growth.toFixed(2)}% per year.</li>`;
//       }
      


//     document.getElementById('resultsArea').innerHTML = text;


//         new Chartist.Line('.ct-chart', {
//         labels: results.result.labels,
//         series: [
//           results.result.series
//         ]
//       }, {
//       low: 0,
//       showArea: true,
//       fullWidth: true,
//       plugins: [
//         Chartist.plugins.tooltip()
//       ]
//       });
//     }

    
//   } catch(err) {
//     // catches errors both in fetch and response.json
//     console.log(err);
//     let text = "Either I can't find it, or its not free cash flow positive...";

//     document.getElementById('resultsArea').innerHTML = text;

//   }


  

  
// }


</script>